{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["class Observer {\n    constructor(data) {\n        // Object.defineProperty 只能劫持已存在的属性（vue里面会为此单独写一些api  $set $delete）\n        this.walk(data)\n    }\n    // 循环对象，对属性依次劫持\n    walk(data) {\n        // “重新定义”属性，性能差\n        Object.keys(data).forEach((key) => defineReactive(data, key, data[key]))\n    }\n}\n\n// 属性劫持(闭包)\nexport function defineReactive(target, key, value) {\n    observe(value) // 深度劫持，对所有对象都进行属性劫持\n    Object.defineProperty(target, key, {\n        // 取值的时候，会执行get\n        get() {\n            return value\n        },\n        // 修改的时候，会执行set\n        set(newValue) {\n            if (newValue === value) return // 如果修改的值和原来的值相同，直接返回\n            observe(newValue) // 如果修改的值是一个对象，对这个对象进行劫持\n            value = newValue\n        }\n    })\n}\n\n// 观测（劫持）data对象\nexport function observe(data) {\n    // 只对对象进行劫持\n    if (typeof data !== 'object' || data == null) {\n        return\n    }\n\n    // 如果一个对象被劫持过了，那就不需要再被劫持了（要判断一个对象是否被劫持过，可以添加一个实例，用实例来判断是够被劫持过）\n    return new Observer(data)\n}\n","import { observe } from './observe/index'\n\nexport function initState(vm) {\n    const opts = vm.$options // 获取所有的选项\n    if (opts.data) {\n        initData(vm) // 初始化数据\n    }\n}\n\nfunction proxy(vm, target, key) {\n    // vm.name --> vm._data.name\n    Object.defineProperty(vm, key, {\n        get() {\n            return vm[target][key]\n        },\n        set(newValue) {\n            vm[target][key] = newValue\n        }\n    })\n}\n\nfunction initData(vm) {\n    let data = vm.$options.data // data 可能是函数和对象\n    data = typeof data === 'function' ? data.call(this) : data\n\n    vm._data = data // 把数据添加到实例的_data上\n    // 对数据进行劫持 vue2里采用了一个API：Object.defineProperty\n    observe(data)\n\n    // 将vm._data 用vm来代理\n    for (let key in data) {\n        proxy(vm, '_data', key)\n    }\n}\n","import { initState } from './state'\n\n// 用来给Vue增加init方法\nexport function initMixin(Vue) {\n    // 用于初始化操作\n    Vue.prototype._init = function (options) {\n        // vue vm.$options 就是获取用户的配置\n\n        // 我们使用vue的时候，以$开头的（$nextTick, $data, $attr）是vue内置属性\n        const vm = this\n        vm.$options = options // 将用户的选项挂载到实例上\n\n        // 初始化状态\n        initState(vm)\n    }\n}\n","import { initMixin } from './init'\n\n// options是用户的选项\nfunction Vue(options) {\n    this._init(options) // 默认调用init\n}\n\ninitMixin(Vue) // 扩展了init方法\n\nexport default Vue\n"],"names":["Observer","data","_classCallCheck","walk","_createClass","key","value","Object","keys","forEach","defineReactive","target","observe","defineProperty","get","set","newValue","_typeof","initState","vm","opts","$options","initData","proxy","call","_data","initMixin","Vue","prototype","_init","options"],"mappings":"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"}